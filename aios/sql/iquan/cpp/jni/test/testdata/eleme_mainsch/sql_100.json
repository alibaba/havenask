{
    "querys": [
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6cb9\u70b8",
                    120.926362,
                    31.932531,
                    39,
                    120.926362,
                    31.932531,
                    "point(120.926362 31.932531)",
                    120.926362,
                    31.932531,
                    "314",
                    0,
                    10000,
                    "\u6cb9\u70b8 OR \u70b8",
                    "\u6cb9\u70b8",
                    120.926362,
                    31.932531,
                    39,
                    120.926362,
                    31.932531,
                    "point(120.926362 31.932531)",
                    120.926362,
                    31.932531,
                    "314",
                    0,
                    10000,
                    "\u6cb9\u70b8 OR \u70b8",
                    "\u6cb9\u70b8",
                    120.926362,
                    31.932531,
                    120.926362,
                    31.932531,
                    39,
                    "point(120.926362 31.932531)",
                    120.926362,
                    31.932531,
                    "314",
                    0,
                    10000,
                    "\u6cb9\u70b8 OR \u70b8"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS httphitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "450:0.011775|1354:0.0131835|778:0.050606|269:0.0137471|209:0.05735|978:0.0232722|882:0.102911|214:0.0153411|249:0.434111|346:0.0139932|218:0.0352395|250:0.16365|221:0.0232171",
                    "[0.102860, 0.024376, -0.289159, -0.284892, -0.025601, 0.110062, -0.143779, 0.168168, 0.414464, -0.266552, -0.259265, -0.407822, -0.281646, -0.043001, -0.254023, -0.264917, -0.199592, -0.058447, 0.044293, -0.157678]",
                    111.730665,
                    40.826473,
                    111.730665,
                    40.826473,
                    92,
                    "point(111.730665 40.826473)",
                    111.730665,
                    40.826473
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u4e1c\u54e5",
                    111.730665,
                    40.826473,
                    92,
                    111.730665,
                    40.826473,
                    "point(111.730665 40.826473)",
                    111.730665,
                    40.826473,
                    "314",
                    0,
                    10000,
                    "\u4e1c\u54e5",
                    "\u4e1c\u54e5",
                    111.730665,
                    40.826473,
                    92,
                    111.730665,
                    40.826473,
                    "point(111.730665 40.826473)",
                    111.730665,
                    40.826473,
                    "314",
                    0,
                    10000,
                    "\u4e1c\u54e5",
                    "\u4e1c\u54e5",
                    111.730665,
                    40.826473,
                    111.730665,
                    40.826473,
                    92,
                    "point(111.730665 40.826473)",
                    111.730665,
                    40.826473,
                    "314",
                    0,
                    10000,
                    "dongge",
                    "dong AND ge",
                    "\u4e1c\u54e5"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  ((QUERY(pinyin_pre,?)  and  QUERY(single_hide,?)) OR QUERY(full_name,?))) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.00875707|209:0.0329486|241:0.211342|882:0.575647|245:0.0196351|214:0.0146284|346:0.00747304|218:0.0192712|221:0.0635995",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    100.714065805,
                    23.5006129928,
                    100.714065805,
                    23.5006129928,
                    294,
                    "point(100.714065805 23.5006129928)",
                    100.714065805,
                    23.5006129928
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1234:0.0418452|1042:0.883362|212:0.0338345",
                    "[-0.049989, 0.173767, -0.230598, 0.139569, 0.121692, 0.093776, -0.067191, -0.189838, 0.420908, -0.336906, -0.438278, -0.303900, -0.217429, 0.173671, -0.216648, -0.108505, -0.255909, 0.229123, -0.000617, -0.035351]",
                    114.164508842,
                    22.6994748786,
                    114.164508842,
                    22.6994748786,
                    51,
                    "point(114.164508842 22.6994748786)",
                    114.164508842,
                    22.6994748786
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.93152|241:0.0161057|212:0.0126379",
                    "[-0.188832, -0.173395, -0.184259, -0.314537, 0.098878, 0.444180, -0.184658, -0.041211, 0.396182, -0.100770, -0.094846, -0.364042, -0.143129, 0.123234, -0.266290, -0.084089, -0.173485, -0.132104, 0.206390, -0.214675]",
                    104.131233953,
                    30.6859879196,
                    104.131233953,
                    30.6859879196,
                    14,
                    "point(104.131233953 30.6859879196)",
                    104.131233953,
                    30.6859879196
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "221:0.993101",
                    "[-0.124174, 0.167060, 0.018063, 0.247627, 0.032854, -0.167491, -0.124400, 0.099980, 0.212748, 0.241595, 0.015491, -0.259733, -0.062867, 0.388433, -0.609798, 0.214606, -0.221884, 0.139785, 0.006655, 0.165930]",
                    121.384437561,
                    31.3248233795,
                    121.384437561,
                    31.3248233795,
                    1,
                    "point(121.384437561 31.3248233795)",
                    121.384437561,
                    31.3248233795
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u8ba2\u4e66\u673a",
                    102.860559896,
                    24.856659919,
                    23,
                    102.860559896,
                    24.856659919,
                    "point(102.860559896 24.856659919)",
                    102.860559896,
                    24.856659919,
                    "314",
                    0,
                    10000,
                    "\u8ba2\u4e66\u673a",
                    "\u8ba2\u4e66\u673a",
                    102.860559896,
                    24.856659919,
                    23,
                    102.860559896,
                    24.856659919,
                    "point(102.860559896 24.856659919)",
                    102.860559896,
                    24.856659919,
                    "314",
                    0,
                    10000,
                    "\u8ba2\u4e66\u673a",
                    "\u8ba2\u4e66\u673a",
                    102.860559896,
                    24.856659919,
                    102.860559896,
                    24.856659919,
                    23,
                    "point(102.860559896 24.856659919)",
                    102.860559896,
                    24.856659919,
                    "314",
                    0,
                    10000,
                    "\u8ba2\u4e66\u673a OR \u8ba2\u4e66\u5668"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9178\u83dc\u9c7c",
                    121.190963745,
                    31.0527992249,
                    1,
                    121.190963745,
                    31.0527992249,
                    "point(121.190963745 31.0527992249)",
                    121.190963745,
                    31.0527992249,
                    "314",
                    0,
                    10000,
                    "\u9178\u83dc\u9c7c",
                    "\u9178\u83dc\u9c7c",
                    121.190963745,
                    31.0527992249,
                    1,
                    121.190963745,
                    31.0527992249,
                    "point(121.190963745 31.0527992249)",
                    121.190963745,
                    31.0527992249,
                    "314",
                    0,
                    10000,
                    "\u9178\u83dc\u9c7c",
                    "\u9178\u83dc\u9c7c",
                    121.190963745,
                    31.0527992249,
                    121.190963745,
                    31.0527992249,
                    1,
                    "point(121.190963745 31.0527992249)",
                    121.190963745,
                    31.0527992249,
                    "314",
                    0,
                    10000,
                    "\u9178\u83dc\u9c7c"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,recent_order_num DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6c34\u679c",
                    102.510375,
                    28.632792,
                    102.510375,
                    28.632792,
                    1938,
                    "point(102.510375 28.632792)",
                    102.510375,
                    28.632792,
                    "314",
                    0,
                    10000,
                    "\u6c34\u679c"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,distance ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.0271111|241:0.199761|249:0.663763|730:0.0354884|250:0.0431173",
                    "[0.208761, -0.043349, -0.299798, -0.298644, 0.104923, -0.078221, -0.137152, 0.059036, 0.338603, -0.251733, -0.226708, -0.500165, -0.176546, 0.090936, -0.111959, -0.392543, -0.136459, 0.092045, -0.034142, -0.148810]",
                    110.185651,
                    25.224274,
                    110.185651,
                    25.224274,
                    98,
                    "point(110.185651 25.224274)",
                    110.185651,
                    25.224274
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1090:0.00593629|263:0.0109042|1322:0.00569739|1354:0.00924997|778:0.00983806|236:0.204132|209:0.0308515|1362:0.021158|978:0.0260921|882:0.0770022|218:0.0165379|442:0.0217626|221:0.51221",
                    "[-0.218279, 0.187054, 0.063024, 0.185003, 0.027251, -0.191440, -0.144161, -0.011941, 0.317960, 0.344288, -0.161036, -0.322150, -0.120087, 0.205865, -0.458009, 0.144590, -0.299429, 0.268282, -0.028417, 0.146915]",
                    121.56956289,
                    31.1608889513,
                    121.56956289,
                    31.1608889513,
                    1,
                    "point(121.56956289 31.1608889513)",
                    121.56956289,
                    31.1608889513
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u7092\u7c73\u7ebf",
                    118.134278,
                    24.505892,
                    13,
                    118.134278,
                    24.505892,
                    "point(118.134278 24.505892)",
                    118.134278,
                    24.505892,
                    "314",
                    0,
                    10000,
                    "\u7c73\u7ebf",
                    "\u7092\u7c73\u7ebf",
                    118.134278,
                    24.505892,
                    13,
                    118.134278,
                    24.505892,
                    "point(118.134278 24.505892)",
                    118.134278,
                    24.505892,
                    "314",
                    0,
                    10000,
                    "\u7c73\u7ebf",
                    "\u7092\u7c73\u7ebf",
                    118.134278,
                    24.505892,
                    118.134278,
                    24.505892,
                    13,
                    "point(118.134278 24.505892)",
                    118.134278,
                    24.505892,
                    "314",
                    0,
                    10000,
                    "\u7c73\u7ebf"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u80dc\u65b9\u6768\u8bb0\u9985\u997c",
                    116.7141723632812,
                    39.08481216430664,
                    596,
                    116.7141723632812,
                    39.08481216430664,
                    "point(116.7141723632812 39.08481216430664)",
                    116.7141723632812,
                    39.08481216430664,
                    "314",
                    "314",
                    0,
                    10000,
                    "\u9e21\u86cb\u997c OR \u8089\u997c OR \u8c46\u6c99\u997c OR \u9677\u997c OR \u97ed\u83dc\u997c OR \u8471\u6cb9\u997c OR \u70e7\u997c OR \u8f6f\u997c OR \u8471\u82b1\u997c OR \u5377\u997c OR \u624b\u6495\u997c",
                    "\u80dc\u65b9\u6768\u8bb0\u9985\u997c",
                    116.7141723632812,
                    39.08481216430664,
                    596,
                    116.7141723632812,
                    39.08481216430664,
                    "point(116.7141723632812 39.08481216430664)",
                    116.7141723632812,
                    39.08481216430664,
                    "314",
                    "314",
                    0,
                    10000,
                    "\u9e21\u86cb\u997c OR \u8089\u997c OR \u8c46\u6c99\u997c OR \u9677\u997c OR \u97ed\u83dc\u997c OR \u8471\u6cb9\u997c OR \u70e7\u997c OR \u8f6f\u997c OR \u8471\u82b1\u997c OR \u5377\u997c OR \u624b\u6495\u997c"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6ce1\u817e\u7247",
                    117.2847290039062,
                    39.05762481689453,
                    5,
                    117.2847290039062,
                    39.05762481689453,
                    "point(117.2847290039062 39.05762481689453)",
                    117.2847290039062,
                    39.05762481689453,
                    "314",
                    0,
                    10000,
                    "\u6ce1\u817e\u7247",
                    "\u6ce1\u817e\u7247",
                    117.2847290039062,
                    39.05762481689453,
                    5,
                    117.2847290039062,
                    39.05762481689453,
                    "point(117.2847290039062 39.05762481689453)",
                    117.2847290039062,
                    39.05762481689453,
                    "314",
                    0,
                    10000,
                    "\u6ce1\u817e\u7247",
                    "\u6ce1\u817e\u7247",
                    117.2847290039062,
                    39.05762481689453,
                    117.2847290039062,
                    39.05762481689453,
                    5,
                    "point(117.2847290039062 39.05762481689453)",
                    117.2847290039062,
                    39.05762481689453,
                    "314",
                    0,
                    10000,
                    "\u6ce1\u817e\u7247"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "218:0.999711",
                    "[-0.185086, 0.197164, -0.093694, 0.260285, 0.031096, -0.251240, -0.305120, 0.086233, 0.400429, 0.142184, -0.268460, -0.197396, -0.190799, 0.304162, -0.254027, 0.006997, -0.280656, 0.255241, -0.020299, 0.237273]",
                    105.100543,
                    31.089583,
                    105.100543,
                    31.089583,
                    82,
                    "point(105.100543 31.089583)",
                    105.100543,
                    31.089583
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u7c73\u7ebf",
                    120.164110847,
                    30.268287845,
                    2,
                    120.164110847,
                    30.268287845,
                    "point(120.164110847 30.268287845)",
                    120.164110847,
                    30.268287845,
                    "314",
                    0,
                    10000,
                    "\u7c73\u7ebf",
                    "\u7c73\u7ebf",
                    120.164110847,
                    30.268287845,
                    2,
                    120.164110847,
                    30.268287845,
                    "point(120.164110847 30.268287845)",
                    120.164110847,
                    30.268287845,
                    "314",
                    0,
                    10000,
                    "\u7c73\u7ebf",
                    "\u7c73\u7ebf",
                    120.164110847,
                    30.268287845,
                    120.164110847,
                    30.268287845,
                    2,
                    "point(120.164110847 30.268287845)",
                    120.164110847,
                    30.268287845,
                    "314",
                    0,
                    10000,
                    "\u7c73\u7ebf"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u4e32\u610f\u5341\u8db3",
                    105.100543,
                    31.089583,
                    105.100543,
                    31.089583,
                    82,
                    "point(105.100543 31.089583)",
                    105.100543,
                    31.089583,
                    "314",
                    0,
                    10000,
                    "chuanyishizu",
                    "chuan AND yi AND shi AND zu",
                    "\u4e32\u610f\u5341\u8db3"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  ((QUERY(pinyin_pre,?)  and  QUERY(single_hide,?)) OR QUERY(name,?))) ORDER BY store_score DESC,avg_cost asc limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u751c\u54c1",
                    103.992634,
                    30.554781,
                    14,
                    103.992634,
                    30.554781,
                    "point(103.992634 30.554781)",
                    103.992634,
                    30.554781,
                    "314",
                    0,
                    10000,
                    "\u751c\u70b9",
                    "\u751c\u54c1",
                    103.992634,
                    30.554781,
                    14,
                    103.992634,
                    30.554781,
                    "point(103.992634 30.554781)",
                    103.992634,
                    30.554781,
                    "314",
                    0,
                    10000,
                    "\u751c\u70b9",
                    "\u751c\u54c1",
                    103.992634,
                    30.554781,
                    103.992634,
                    30.554781,
                    14,
                    "point(103.992634 30.554781)",
                    103.992634,
                    30.554781,
                    "314",
                    0,
                    10000,
                    "\u751c\u70b9 OR \u751c\u54c1"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'area_agent_fee','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'area_agent_fee','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,bit_value(delivery_bit , 0 , 20) ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6e58",
                    120.35694,
                    30.31815,
                    2,
                    120.35694,
                    30.31815,
                    "point(120.35694 30.31815)",
                    120.35694,
                    30.31815,
                    "314",
                    0,
                    10000,
                    "\u6e58",
                    "\u6e58",
                    "\u6e58",
                    120.35694,
                    30.31815,
                    2,
                    120.35694,
                    30.31815,
                    "point(120.35694 30.31815)",
                    120.35694,
                    30.31815,
                    "314",
                    0,
                    10000,
                    "\u6e58",
                    "\u6e58",
                    "\u6e58",
                    120.35694,
                    30.31815,
                    120.35694,
                    30.31815,
                    2,
                    "point(120.35694 30.31815)",
                    120.35694,
                    30.31815,
                    "314",
                    0,
                    10000,
                    "\u6e58",
                    "\u6e58",
                    "xiang"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'distance','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?) AND QUERY(single_name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'distance','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?) AND QUERY(single_name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  (QUERY(full_name,?) OR QUERY(single_name,?) OR QUERY(pinyin_pre,?))) ORDER BY store_score DESC,distance ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u7092\u996d",
                    106.53045,
                    29.56827,
                    44,
                    106.53045,
                    29.56827,
                    "point(106.53045 29.56827)",
                    106.53045,
                    29.56827,
                    "314",
                    0,
                    10000,
                    "\u7092\u996d OR \u7092\u7c73\u996d",
                    "\u7092\u996d",
                    106.53045,
                    29.56827,
                    44,
                    106.53045,
                    29.56827,
                    "point(106.53045 29.56827)",
                    106.53045,
                    29.56827,
                    "314",
                    0,
                    10000,
                    "\u7092\u996d OR \u7092\u7c73\u996d",
                    "\u7092\u996d",
                    106.53045,
                    29.56827,
                    106.53045,
                    29.56827,
                    44,
                    "point(106.53045 29.56827)",
                    106.53045,
                    29.56827,
                    "314",
                    0,
                    10000,
                    "\u7092\u996d OR \u7092\u7c73\u996d"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'd_time','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'd_time','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,d_time ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u5409\u7965\u6df7\u6c8c",
                    123.33896689116955,
                    41.38040989637375,
                    123.33896689116955,
                    41.38040989637375,
                    1436,
                    "point(123.33896689116955 41.38040989637375)",
                    123.33896689116955,
                    41.38040989637375,
                    "314",
                    0,
                    10000,
                    "\u6241\u98df OR \u9984\u9968 OR \u6284\u624b"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "212:0.952802",
                    "[0.037109, 0.201456, -0.233653, 0.267782, 0.111438, 0.075403, 0.002954, -0.056959, 0.454904, -0.228371, -0.427591, -0.417244, -0.223685, 0.139611, -0.216028, -0.031072, -0.120321, 0.166174, -0.056599, -0.178632]",
                    115.2072982788086,
                    37.92983245849609,
                    115.2072982788086,
                    37.92983245849609,
                    31,
                    "point(115.2072982788086 37.92983245849609)",
                    115.2072982788086,
                    37.92983245849609
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u5409\u7965\u6df7\u6c8c",
                    123.33896689116955,
                    41.38040989637375,
                    1436,
                    123.33896689116955,
                    41.38040989637375,
                    "point(123.33896689116955 41.38040989637375)",
                    123.33896689116955,
                    41.38040989637375,
                    "314",
                    "314",
                    0,
                    10000,
                    "\u6241\u5b9e OR \u6241\u7c89 OR \u6241\u8089 OR \u6241\u9762 OR \u71c3\u6284",
                    "\u5409\u7965\u6df7\u6c8c",
                    123.33896689116955,
                    41.38040989637375,
                    1436,
                    123.33896689116955,
                    41.38040989637375,
                    "point(123.33896689116955 41.38040989637375)",
                    123.33896689116955,
                    41.38040989637375,
                    "314",
                    "314",
                    0,
                    10000,
                    "\u6241\u5b9e OR \u6241\u7c89 OR \u6241\u8089 OR \u6241\u9762 OR \u71c3\u6284"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6c99\u62c9",
                    121.2411041259766,
                    31.39221000671387,
                    1,
                    121.2411041259766,
                    31.39221000671387,
                    "point(121.2411041259766 31.39221000671387)",
                    121.2411041259766,
                    31.39221000671387,
                    "1074|212|1090|1106|1114|1122|1138|1154|1130|1170|1162|1234|1066|1186|1050|1058|1178|1146|370|882|268|594|530|538|1082|209|546|666|1338|562|570|578|586|602|226|698|810|228|690|267|610|222|269|682|674|658|650|227|642|1042|266|626|618|1194|224|506|634|1098|225|221|706|554|263|522|898|514|223|1218|442|818|1210|434|1202|232|426|1226|450",
                    "314",
                    0,
                    10000,
                    "'#\u8272\u62c9\u8f7b\u98df\u8272\u62c9'",
                    "\u6c99\u62c9",
                    121.2411041259766,
                    31.39221000671387,
                    1,
                    121.2411041259766,
                    31.39221000671387,
                    "point(121.2411041259766 31.39221000671387)",
                    121.2411041259766,
                    31.39221000671387,
                    "1074|212|1090|1106|1114|1122|1138|1154|1130|1170|1162|1234|1066|1186|1050|1058|1178|1146|370|882|268|594|530|538|1082|209|546|666|1338|562|570|578|586|602|226|698|810|228|690|267|610|222|269|682|674|658|650|227|642|1042|266|626|618|1194|224|506|634|1098|225|221|706|554|263|522|898|514|223|1218|442|818|1210|434|1202|232|426|1226|450",
                    "314",
                    0,
                    10000,
                    "'#\u8272\u62c9\u8f7b\u98df\u8272\u62c9'"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(tag_names,?))))))) )  UNION ALL  ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(tag_names,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6c64",
                    118.126426697,
                    24.5998191833,
                    13,
                    118.126426697,
                    24.5998191833,
                    "point(118.126426697 24.5998191833)",
                    118.126426697,
                    24.5998191833,
                    "314",
                    0,
                    10000,
                    "\u6c64",
                    "\u6c64",
                    "\u6c64",
                    118.126426697,
                    24.5998191833,
                    13,
                    118.126426697,
                    24.5998191833,
                    "point(118.126426697 24.5998191833)",
                    118.126426697,
                    24.5998191833,
                    "314",
                    0,
                    10000,
                    "\u6c64",
                    "\u6c64",
                    "\u6c64",
                    118.126426697,
                    24.5998191833,
                    118.126426697,
                    24.5998191833,
                    13,
                    "point(118.126426697 24.5998191833)",
                    118.126426697,
                    24.5998191833,
                    "314",
                    0,
                    10000,
                    "\u6c64",
                    "\u6c64"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'd_time','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?) AND QUERY(single_name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'd_time','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?) AND QUERY(single_name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  (QUERY(single_name,?) OR QUERY(name,?))) ORDER BY store_score DESC,d_time ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.0185883|1234:0.0344147|882:0.126153|978:0.233128|1154:0.441722|1146:0.0949776|254:0.0154734",
                    "[-0.194296, 0.322191, -0.159488, 0.327333, 0.085790, -0.117400, -0.186062, -0.076020, 0.380757, -0.014153, -0.158021, -0.328894, -0.095079, 0.245414, -0.457928, 0.137227, -0.287826, 0.072919, 0.001949, -0.006040]",
                    121.8377532958984,
                    29.89014434814453,
                    121.8377532958984,
                    29.89014434814453,
                    18,
                    "point(121.8377532958984 29.89014434814453)",
                    121.8377532958984,
                    29.89014434814453
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.0877816|754:0.00705489|978:0.0222514|466:0.0268454|562:0.0434131|882:0.324378|778:0.01189|762:0.0191348|266:0.293726|269:0.0136276|221:0.0156217|222:0.0879319",
                    "[-0.195935, 0.270209, 0.005103, 0.258821, 0.063674, -0.009733, -0.151085, -0.236865, 0.205180, 0.112237, -0.018313, -0.422705, -0.176575, 0.184098, -0.469976, 0.164488, -0.320706, 0.256822, -0.002196, 0.151562]",
                    121.259040833,
                    28.6547298431,
                    121.259040833,
                    28.6547298431,
                    52,
                    "point(121.259040833 28.6547298431)",
                    121.259040833,
                    28.6547298431
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1154:0.00554545|962:0.0165249|450:0.0206146|263:0.00753674|458:0.0048347|778:0.00634559|1034:0.00823464|267:0.00244781|269:0.00492711|209:0.025736|1042:0.00512637|1234:0.00564617|1362:0.0064914|978:0.0559419|212:0.0156602|214:0.0146079|794:0.00267168|346:0.00765843|218:0.326506|221:0.0362326|223:0.00863311|225:0.00519801|232:0.0139404|1258:0.00347999|1322:0.00673256|234:0.1884|236:0.0205882|240:0.00677727|434:0.00291803|1330:0.00532617|754:0.00816193|882:0.0830735|1146:0.00474709|762:0.0101654|570:0.00335186",
                    "[-0.169241, 0.235600, -0.175485, 0.293682, -0.001240, -0.187204, -0.256248, 0.035597, 0.419734, 0.085244, -0.273064, -0.247808, -0.192048, 0.247715, -0.316439, 0.067914, -0.257353, 0.260849, -0.041768, 0.195972]",
                    113.932831,
                    22.526108,
                    113.932831,
                    22.526108,
                    11,
                    "point(113.932831 22.526108)",
                    113.932831,
                    22.526108
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "225:0.00711013|209:0.270932|1042:0.00575321|978:0.00801499|450:0.0137746|882:0.557962|236:0.0803589|221:0.00626822",
                    "[-0.202598, 0.248851, -0.041730, 0.235644, 0.115229, -0.041363, -0.130938, -0.152822, 0.332177, 0.148993, -0.166169, -0.395242, -0.141488, 0.142267, -0.498891, 0.108470, -0.365953, 0.177979, -0.000227, 0.037215]",
                    114.123465,
                    22.541423,
                    114.123465,
                    22.541423,
                    11,
                    "point(114.123465 22.541423)",
                    114.123465,
                    22.541423
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u828b\u5706",
                    120.61895752,
                    28.0408287048,
                    30,
                    120.61895752,
                    28.0408287048,
                    "point(120.61895752 28.0408287048)",
                    120.61895752,
                    28.0408287048,
                    "314",
                    0,
                    10000,
                    "\u828b\u5706",
                    "\u828b\u5706",
                    120.61895752,
                    28.0408287048,
                    30,
                    120.61895752,
                    28.0408287048,
                    "point(120.61895752 28.0408287048)",
                    120.61895752,
                    28.0408287048,
                    "314",
                    0,
                    10000,
                    "\u828b\u5706",
                    "\u828b\u5706",
                    120.61895752,
                    28.0408287048,
                    120.61895752,
                    28.0408287048,
                    30,
                    "point(120.61895752 28.0408287048)",
                    120.61895752,
                    28.0408287048,
                    "314",
                    0,
                    10000,
                    "\u828b\u5706"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "225:0.0397874|263:0.0201365|458:0.00399306|1354:0.00501289|267:0.0052503|236:0.0067613|209:0.0584886|754:0.0076862|978:0.0157507|1298:0.0279802|1362:0.029013|882:0.191682|214:0.00525133|570:0.011244|442:0.00490331|221:0.50932|222:0.00505364|223:0.00467359",
                    "[-0.271431, 0.209621, 0.053011, 0.190367, 0.065272, -0.203265, -0.039243, 0.010856, 0.341044, 0.264425, -0.121531, -0.335663, -0.081728, 0.243476, -0.475399, 0.190362, -0.317245, 0.216269, -0.030686, 0.076603]",
                    120.526259691,
                    27.9914239794,
                    120.526259691,
                    27.9914239794,
                    30,
                    "point(120.526259691 27.9914239794)",
                    120.526259691,
                    27.9914239794
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "882:0.0188639|214:0.942528",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    102.709498,
                    25.039331,
                    102.709498,
                    25.039331,
                    23,
                    "point(102.709498 25.039331)",
                    102.709498,
                    25.039331
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.0212886|209:0.016792|978:0.00945326|882:0.0289283|1042:0.0395968|212:0.662783|218:0.0706194|234:0.108983",
                    "[-0.079080, 0.186780, -0.229541, 0.216395, 0.099963, 0.078349, -0.033458, -0.178076, 0.430894, -0.268835, -0.390126, -0.319313, -0.310140, 0.204609, -0.194238, -0.041835, -0.276676, 0.210012, 0.006339, -0.007418]",
                    113.953503817,
                    22.5388368778,
                    113.953503817,
                    22.5388368778,
                    11,
                    "point(113.953503817 22.5388368778)",
                    113.953503817,
                    22.5388368778
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u4e00\u7096",
                    106.707616746,
                    26.57922199,
                    137,
                    106.707616746,
                    26.57922199,
                    "point(106.707616746 26.57922199)",
                    106.707616746,
                    26.57922199,
                    "314",
                    0,
                    10000,
                    "\u4e00\u7096",
                    "\u4e00\u7096",
                    106.707616746,
                    26.57922199,
                    137,
                    106.707616746,
                    26.57922199,
                    "point(106.707616746 26.57922199)",
                    106.707616746,
                    26.57922199,
                    "314",
                    0,
                    10000,
                    "\u4e00\u7096",
                    "\u4e00\u7096",
                    106.707616746,
                    26.57922199,
                    106.707616746,
                    26.57922199,
                    137,
                    "point(106.707616746 26.57922199)",
                    106.707616746,
                    26.57922199,
                    "314",
                    0,
                    10000,
                    "yidun",
                    "yi AND dun",
                    "\u4e00\u7096"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'distance','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'distance','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  ((QUERY(pinyin_pre,?)  and  QUERY(single_hide,?)) OR QUERY(full_name,?))) ORDER BY store_score DESC,distance ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.032233|209:0.00989657|978:0.0144815|882:0.0309323|212:0.178421|218:0.0109183|234:0.673517",
                    "[-0.140276, 0.187387, -0.213328, 0.247907, 0.055128, 0.063495, -0.153544, -0.210469, 0.412932, -0.102483, -0.442634, -0.315776, -0.302876, 0.191063, -0.230298, -0.024447, -0.266519, 0.182877, 0.014961, 0.008343]",
                    114.924460799,
                    24.4584688917,
                    114.924460799,
                    24.4584688917,
                    365,
                    "point(114.924460799 24.4584688917)",
                    114.924460799,
                    24.4584688917
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u732a\u809d",
                    113.096350953,
                    23.418040853,
                    4,
                    113.096350953,
                    23.418040853,
                    "point(113.096350953 23.418040853)",
                    113.096350953,
                    23.418040853,
                    "314",
                    0,
                    10000,
                    "\u732a\u6da6 OR \u732a\u809d",
                    "\u732a\u809d",
                    113.096350953,
                    23.418040853,
                    4,
                    113.096350953,
                    23.418040853,
                    "point(113.096350953 23.418040853)",
                    113.096350953,
                    23.418040853,
                    "314",
                    0,
                    10000,
                    "\u732a\u6da6 OR \u732a\u809d",
                    "\u732a\u809d",
                    113.096350953,
                    23.418040853,
                    113.096350953,
                    23.418040853,
                    4,
                    "point(113.096350953 23.418040853)",
                    113.096350953,
                    23.418040853,
                    "314",
                    0,
                    10000,
                    "\u732a\u6da6 OR \u732a\u809d"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_favorable_rate','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_favorable_rate','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,favorable_rate DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "450:0.00798531|490:0.00603878|1258:0.00891162|1034:0.00895983|234:0.699857|209:0.0135264|402:0.0129294|754:0.017036|978:0.020746|882:0.066253|212:0.0101036|214:0.0310523|218:0.0500187",
                    "[-0.178072, 0.312279, -0.167129, 0.235478, 0.021108, -0.141574, -0.218918, 0.073534, 0.446121, -0.001452, -0.303878, -0.241704, -0.220187, 0.259707, -0.302477, 0.054830, -0.276773, 0.261682, -0.009867, 0.090407]",
                    126.55922368168831,
                    43.90837697312236,
                    126.55922368168831,
                    43.90837697312236,
                    101,
                    "point(126.55922368168831 43.90837697312236)",
                    126.55922368168831,
                    43.90837697312236
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "224:0.00327792|770:0.0015987|802:0.00359922|1058:0.00541439|263:0.00207587|266:0.00154311|330:0.00163571|586:0.0092826|240:0.00627401|241:0.00317994|1330:0.00159838|754:0.00161766|1074:0.00171583|882:0.00180999|306:0.892519|245:0.0059257|762:0.00167521|794:0.00204171|730:0.0021771|221:0.0016132",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    114.26423471421003,
                    30.59420892968774,
                    114.26423471421003,
                    30.59420892968774,
                    7,
                    "point(114.26423471421003 30.59420892968774)",
                    114.26423471421003,
                    30.59420892968774
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9178\u8fa3\u7c89",
                    115.63899993896484,
                    22.958228923380375,
                    544,
                    115.63899993896484,
                    22.958228923380375,
                    "point(115.63899993896484 22.958228923380375)",
                    115.63899993896484,
                    22.958228923380375,
                    "314",
                    0,
                    10000,
                    "\u9178\u8fa3\u7c89",
                    "\u9178\u8fa3\u7c89",
                    115.63899993896484,
                    22.958228923380375,
                    544,
                    115.63899993896484,
                    22.958228923380375,
                    "point(115.63899993896484 22.958228923380375)",
                    115.63899993896484,
                    22.958228923380375,
                    "314",
                    0,
                    10000,
                    "\u9178\u8fa3\u7c89",
                    "\u9178\u8fa3\u7c89",
                    115.63899993896484,
                    22.958228923380375,
                    115.63899993896484,
                    22.958228923380375,
                    544,
                    "point(115.63899993896484 22.958228923380375)",
                    115.63899993896484,
                    22.958228923380375,
                    "314",
                    0,
                    10000,
                    "\u9178\u8fa3\u7c89"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u835e\u9ea6\u9762\u6c34\u997a",
                    118.30026995390654,
                    35.06859289482236,
                    60,
                    118.30026995390654,
                    35.06859289482236,
                    "point(118.30026995390654 35.06859289482236)",
                    118.30026995390654,
                    35.06859289482236,
                    "245|322|256|282|1386|730|258|290|1410|938|254|490|866|1442|498|874|1466|338|250|1026|240|249|1370|714|242|738|274|842|826|1450|270|834|241|890|306|247|858|246|954|482|1418|946|474|850|271|330|922|1394|273|298|257|1378|930|1402|1458|255|314",
                    "314",
                    0,
                    10000,
                    "'#\u4e3b\u98df\u997a\u5b50'",
                    "\u835e\u9ea6\u9762\u6c34\u997a",
                    118.30026995390654,
                    35.06859289482236,
                    60,
                    118.30026995390654,
                    35.06859289482236,
                    "point(118.30026995390654 35.06859289482236)",
                    118.30026995390654,
                    35.06859289482236,
                    "245|322|256|282|1386|730|258|290|1410|938|254|490|866|1442|498|874|1466|338|250|1026|240|249|1370|714|242|738|274|842|826|1450|270|834|241|890|306|247|858|246|954|482|1418|946|474|850|271|330|922|1394|273|298|257|1378|930|1402|1458|255|314",
                    "314",
                    0,
                    10000,
                    "'#\u4e3b\u98df\u997a\u5b50'"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(tag_names,?))))))) )  UNION ALL  ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(tag_names,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9e21\u80f8\u8089",
                    119.3667678833008,
                    34.75791931152344,
                    89,
                    119.3667678833008,
                    34.75791931152344,
                    "point(119.3667678833008 34.75791931152344)",
                    119.3667678833008,
                    34.75791931152344,
                    "314",
                    0,
                    10000,
                    "\u9e21\u80f8\u8089",
                    "\u9e21\u80f8\u8089",
                    119.3667678833008,
                    34.75791931152344,
                    89,
                    119.3667678833008,
                    34.75791931152344,
                    "point(119.3667678833008 34.75791931152344)",
                    119.3667678833008,
                    34.75791931152344,
                    "314",
                    0,
                    10000,
                    "\u9e21\u80f8\u8089",
                    "\u9e21\u80f8\u8089",
                    119.3667678833008,
                    34.75791931152344,
                    119.3667678833008,
                    34.75791931152344,
                    89,
                    "point(119.3667678833008 34.75791931152344)",
                    119.3667678833008,
                    34.75791931152344,
                    "314",
                    0,
                    10000,
                    "\u9e21\u80f8\u8089"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "882:0.011704|212:0.858172|234:0.089367",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    103.732297,
                    29.558235,
                    103.732297,
                    29.558235,
                    139,
                    "point(103.732297 29.558235)",
                    103.732297,
                    29.558235
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u624b\u6293\u997c",
                    113.776528,
                    23.037299,
                    51,
                    113.776528,
                    23.037299,
                    "point(113.776528 23.037299)",
                    113.776528,
                    23.037299,
                    "314",
                    0,
                    10000,
                    "\u624b\u6293\u997c",
                    "\u624b\u6293\u997c",
                    113.776528,
                    23.037299,
                    51,
                    113.776528,
                    23.037299,
                    "point(113.776528 23.037299)",
                    113.776528,
                    23.037299,
                    "314",
                    0,
                    10000,
                    "\u624b\u6293\u997c",
                    "\u624b\u6293\u997c",
                    113.776528,
                    23.037299,
                    113.776528,
                    23.037299,
                    51,
                    "point(113.776528 23.037299)",
                    113.776528,
                    23.037299,
                    "314",
                    0,
                    10000,
                    "\u624b\u6293\u997c"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,recent_order_num DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6d0b\u828b\u996d",
                    114.019262,
                    22.533984,
                    11,
                    114.019262,
                    22.533984,
                    "point(114.019262 22.533984)",
                    114.019262,
                    22.533984,
                    "314",
                    0,
                    10000,
                    "\u6d0b\u828b\u996d",
                    "\u6d0b\u828b\u996d",
                    114.019262,
                    22.533984,
                    11,
                    114.019262,
                    22.533984,
                    "point(114.019262 22.533984)",
                    114.019262,
                    22.533984,
                    "314",
                    0,
                    10000,
                    "\u6d0b\u828b\u996d",
                    "\u6d0b\u828b\u996d",
                    114.019262,
                    22.533984,
                    114.019262,
                    22.533984,
                    11,
                    "point(114.019262 22.533984)",
                    114.019262,
                    22.533984,
                    "314",
                    0,
                    10000,
                    "\u6d0b\u828b\u996d"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u4e00\u70b9\u70b9",
                    121.428421021,
                    31.2811279297,
                    121.428421021,
                    31.2811279297,
                    1,
                    "point(121.428421021 31.2811279297)",
                    121.428421021,
                    31.2811279297,
                    "314",
                    0,
                    10000,
                    "\u4e00\u70b9\u70b9 OR 1\u70b9\u70b9"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,d_time ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u767e\u5e74\u997a\u5b50",
                    115.37243,
                    26.31482,
                    129,
                    115.37243,
                    26.31482,
                    "point(115.37243 26.31482)",
                    115.37243,
                    26.31482,
                    "314",
                    0,
                    10000,
                    "\u997a\u5b50",
                    "\u767e\u5e74\u997a\u5b50",
                    115.37243,
                    26.31482,
                    129,
                    115.37243,
                    26.31482,
                    "point(115.37243 26.31482)",
                    115.37243,
                    26.31482,
                    "314",
                    0,
                    10000,
                    "\u997a\u5b50",
                    "\u767e\u5e74\u997a\u5b50",
                    115.37243,
                    26.31482,
                    115.37243,
                    26.31482,
                    129,
                    "point(115.37243 26.31482)",
                    115.37243,
                    26.31482,
                    "314",
                    0,
                    10000,
                    "\u6c34\u997a"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.021115|882:0.571088|794:0.359431",
                    "[-0.151934, 0.219158, 0.103483, -0.002189, 0.208483, -0.308494, -0.250900, 0.467933, 0.144699, -0.114174, 0.062348, -0.175731, -0.010570, 0.284894, -0.535087, 0.222774, 0.030118, 0.096440, 0.024195, 0.029479]",
                    121.45400238,
                    31.2281703949,
                    121.45400238,
                    31.2281703949,
                    1,
                    "point(121.45400238 31.2281703949)",
                    121.45400238,
                    31.2281703949
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u62ab\u8428",
                    120.396297,
                    36.137123,
                    28,
                    120.396297,
                    36.137123,
                    "point(120.396297 36.137123)",
                    120.396297,
                    36.137123,
                    "314",
                    "314",
                    0,
                    10000,
                    "'#\u4e3b\u98df\u62ab\u8428'",
                    "\u62ab\u8428",
                    120.396297,
                    36.137123,
                    28,
                    120.396297,
                    36.137123,
                    "point(120.396297 36.137123)",
                    120.396297,
                    36.137123,
                    "314",
                    "314",
                    0,
                    10000,
                    "'#\u4e3b\u98df\u62ab\u8428'"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(tag_names,?))))))) )  UNION ALL  ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(tag_names,?))))))) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.00646287|1362:0.0249476|882:0.027168|1338:0.838441|267:0.0334044|269:0.00877922|221:0.0145772",
                    "[-0.212914, 0.300505, 0.093661, 0.186265, 0.008892, -0.272632, -0.031866, 0.207199, 0.293644, 0.135762, -0.088016, -0.306520, -0.048797, 0.279059, -0.358240, 0.217036, -0.369194, 0.293104, 0.034203, 0.130781]",
                    114.116744995,
                    22.5401821136,
                    114.116744995,
                    22.5401821136,
                    11,
                    "point(114.116744995 22.5401821136)",
                    114.116744995,
                    22.5401821136
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "218:0.956019",
                    "[-0.174967, 0.220651, -0.087279, 0.237743, 0.002891, -0.235047, -0.306173, 0.110457, 0.433186, 0.174356, -0.223774, -0.185192, -0.184742, 0.283141, -0.297267, 0.064866, -0.280151, 0.242133, -0.025528, 0.219780]",
                    118.152347,
                    24.496419,
                    118.152347,
                    24.496419,
                    13,
                    "point(118.152347 24.496419)",
                    118.152347,
                    24.496419
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u7d2b\u85af\u7ca5",
                    113.34609,
                    23.11777,
                    4,
                    113.34609,
                    23.11777,
                    "point(113.34609 23.11777)",
                    113.34609,
                    23.11777,
                    "314",
                    0,
                    10000,
                    "\u7d2b\u85af\u7ca5",
                    "\u7d2b\u85af\u7ca5",
                    113.34609,
                    23.11777,
                    4,
                    113.34609,
                    23.11777,
                    "point(113.34609 23.11777)",
                    113.34609,
                    23.11777,
                    "314",
                    0,
                    10000,
                    "\u7d2b\u85af\u7ca5",
                    "\u7d2b\u85af\u7ca5",
                    113.34609,
                    23.11777,
                    113.34609,
                    23.11777,
                    4,
                    "point(113.34609 23.11777)",
                    113.34609,
                    23.11777,
                    "314",
                    0,
                    10000,
                    "\u7d2b\u85af\u7ca5"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_favorable_rate','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_favorable_rate','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,favorable_rate DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.838603|241:0.0336009|882:0.0106847|978:0.0169323|212:0.037171|234:0.0227463",
                    "[-0.187848, -0.151756, -0.176747, -0.298121, 0.094862, 0.444224, -0.178347, -0.040947, 0.389463, -0.109520, -0.117754, -0.382041, -0.157894, 0.128350, -0.250584, -0.077834, -0.175311, -0.121752, 0.220857, -0.231650]",
                    113.08467395603657,
                    22.91902692988515,
                    113.08467395603657,
                    22.91902692988515,
                    24,
                    "point(113.08467395603657 22.91902692988515)",
                    113.08467395603657,
                    22.91902692988515
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u65b0\u7586",
                    121.5502548217773,
                    31.20382881164551,
                    121.5502548217773,
                    31.20382881164551,
                    1,
                    "point(121.5502548217773 31.20382881164551)",
                    121.5502548217773,
                    31.20382881164551,
                    "314",
                    "228",
                    0,
                    10000
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(10 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=?) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6392\u9aa8\u996d",
                    118.14865674823523,
                    24.529725965112448,
                    13,
                    118.14865674823523,
                    24.529725965112448,
                    "point(118.14865674823523 24.529725965112448)",
                    118.14865674823523,
                    24.529725965112448,
                    "314",
                    "818",
                    0,
                    10000,
                    "\u6392\u9aa8\u996d",
                    "\u6392\u9aa8\u996d",
                    118.14865674823523,
                    24.529725965112448,
                    13,
                    118.14865674823523,
                    24.529725965112448,
                    "point(118.14865674823523 24.529725965112448)",
                    118.14865674823523,
                    24.529725965112448,
                    "314",
                    "818",
                    0,
                    10000,
                    "\u6392\u9aa8\u996d"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(10 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(10 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9ec4\u91d1\u7cd5",
                    120.4557417333126,
                    31.368804909288883,
                    8,
                    120.4557417333126,
                    31.368804909288883,
                    "point(120.4557417333126 31.368804909288883)",
                    120.4557417333126,
                    31.368804909288883,
                    "1466|245|1450|274|282|258|330|1274|1442|498|256|1290|1354|338|1282|306|1250|322|1266|490|1362|890|826|1298|482|954|1346|874|842|1314|834|1306|850|1322|866|1330|858|214|922|1394|273|1378|257|298|458|930|1402|938|1410|1458|474|946|1418|1258|255|314",
                    "314",
                    0,
                    10000,
                    "'#\u751c\u70b9\u7cd5\u70b9'",
                    "\u9ec4\u91d1\u7cd5",
                    120.4557417333126,
                    31.368804909288883,
                    8,
                    120.4557417333126,
                    31.368804909288883,
                    "point(120.4557417333126 31.368804909288883)",
                    120.4557417333126,
                    31.368804909288883,
                    "1466|245|1450|274|282|258|330|1274|1442|498|256|1290|1354|338|1282|306|1250|322|1266|490|1362|890|826|1298|482|954|1346|874|842|1314|834|1306|850|1322|866|1330|858|214|922|1394|273|1378|257|298|458|930|1402|938|1410|1458|474|946|1418|1258|255|314",
                    "314",
                    0,
                    10000,
                    "'#\u751c\u70b9\u7cd5\u70b9'"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(tag_names,?))))))) )  UNION ALL  ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(tag_names,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9762\u5305",
                    116.3963394165039,
                    39.97505569458008,
                    3,
                    116.3963394165039,
                    39.97505569458008,
                    "point(116.3963394165039 39.97505569458008)",
                    116.3963394165039,
                    39.97505569458008,
                    "314",
                    "250",
                    0,
                    10000,
                    "\u9762\u5305",
                    "\u9762\u5305",
                    116.3963394165039,
                    39.97505569458008,
                    3,
                    116.3963394165039,
                    39.97505569458008,
                    "point(116.3963394165039 39.97505569458008)",
                    116.3963394165039,
                    39.97505569458008,
                    "314",
                    "250",
                    0,
                    10000,
                    "\u9762\u5305"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(10 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(10 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "770:0.00445422|450:0.539248|263:0.00469852|394:0.00479042|778:0.0180658|267:0.00306616|269:0.00327799|209:0.0573745|786:0.00255034|1042:0.00365866|1234:0.00435496|978:0.0140481|212:0.00261777|214:0.00224137|346:0.00336376|794:0.00339901|218:0.02125|221:0.0281275|222:0.00330663|223:0.00794876|225:0.00440235|802:0.00445264|234:0.00600779|236:0.0032914|562:0.00251046|434:0.00421201|754:0.0106155|370:0.017323|882:0.138039|1146:0.00220691|826:0.0024237|890:0.00268477|442:0.00294366|762:0.0175655",
                    "[-0.170742, 0.307091, -0.127991, 0.331622, 0.094323, -0.095641, -0.164134, -0.036794, 0.334764, 0.045687, -0.106156, -0.367824, -0.114269, 0.220367, -0.537032, 0.147460, -0.176928, 0.174865, 0.083980, 0.049301]",
                    116.29994083195925,
                    39.9246858805418,
                    116.29994083195925,
                    39.9246858805418,
                    3,
                    "point(116.29994083195925 39.9246858805418)",
                    116.29994083195925,
                    39.9246858805418
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u70b8\u9e21",
                    119.9953593313694,
                    36.80230960249901,
                    28,
                    119.9953593313694,
                    36.80230960249901,
                    "point(119.9953593313694 36.80230960249901)",
                    119.9953593313694,
                    36.80230960249901,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9e21",
                    "\u70b8\u9e21",
                    119.9953593313694,
                    36.80230960249901,
                    28,
                    119.9953593313694,
                    36.80230960249901,
                    "point(119.9953593313694 36.80230960249901)",
                    119.9953593313694,
                    36.80230960249901,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9e21",
                    "\u70b8\u9e21",
                    119.9953593313694,
                    36.80230960249901,
                    119.9953593313694,
                    36.80230960249901,
                    28,
                    "point(119.9953593313694 36.80230960249901)",
                    119.9953593313694,
                    36.80230960249901,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9e21"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,recent_order_num DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u70b8\u9e21",
                    119.9953593313694,
                    36.80230960249901,
                    28,
                    119.9953593313694,
                    36.80230960249901,
                    "point(119.9953593313694 36.80230960249901)",
                    119.9953593313694,
                    36.80230960249901,
                    "314",
                    "314",
                    0,
                    10000,
                    "'#\u5c0f\u5403\u70b8\u8d27\u70b8\u9e21'",
                    "\u70b8\u9e21",
                    119.9953593313694,
                    36.80230960249901,
                    28,
                    119.9953593313694,
                    36.80230960249901,
                    "point(119.9953593313694 36.80230960249901)",
                    119.9953593313694,
                    36.80230960249901,
                    "314",
                    "314",
                    0,
                    10000,
                    "'#\u5c0f\u5403\u70b8\u8d27\u70b8\u9e21'"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(tag_names,?))))))) )  UNION ALL  ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-recent_order_num','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time,recent_order_num FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(tag_names,?))))))) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "450:0.00220665|1346:0.00450371|263:0.0152284|778:0.00743455|458:0.00786382|1354:0.0366104|267:0.00866779|269:0.00374896|209:0.0782519|978:0.014059|1298:0.0333347|1362:0.037346|214:0.0140138|1114:0.00258587|794:0.00273364|218:0.00882734|221:0.370308|222:0.00526844|223:0.00791826|224:0.00545093|225:0.0182733|546:0.00223077|226:0.00255356|227:0.00589977|232:0.00286327|234:0.00226207|236:0.00744404|434:0.00260929|754:0.00808033|882:0.218586|1338:0.00227871|570:0.00532969|442:0.00374376|762:0.00346983",
                    "[-0.291480, 0.212906, 0.034881, 0.190346, 0.079738, -0.182661, -0.034605, -0.016183, 0.360387, 0.237035, -0.159246, -0.350069, -0.093345, 0.219082, -0.455332, 0.173389, -0.334684, 0.217965, -0.041400, 0.042052]",
                    118.312826,
                    32.271857,
                    118.312826,
                    32.271857,
                    83,
                    "point(118.312826 32.271857)",
                    118.312826,
                    32.271857
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "271:0.987893",
                    "[0.029872, -0.046094, -0.152862, -0.254518, -0.067012, 0.138704, 0.048839, 0.104565, 0.645420, -0.124745, -0.087821, -0.410271, -0.288321, 0.010151, -0.023436, -0.049893, -0.237518, -0.253693, -0.220955, -0.088080]",
                    102.825737,
                    24.8312034607,
                    102.825737,
                    24.8312034607,
                    23,
                    "point(102.825737 24.8312034607)",
                    102.825737,
                    24.8312034607
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u70b8\u9992\u5934",
                    113.3387146,
                    23.1254577637,
                    4,
                    113.3387146,
                    23.1254577637,
                    "point(113.3387146 23.1254577637)",
                    113.3387146,
                    23.1254577637,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9992\u5934",
                    "\u70b8\u9992\u5934",
                    113.3387146,
                    23.1254577637,
                    4,
                    113.3387146,
                    23.1254577637,
                    "point(113.3387146 23.1254577637)",
                    113.3387146,
                    23.1254577637,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9992\u5934",
                    "\u70b8\u9992\u5934",
                    113.3387146,
                    23.1254577637,
                    113.3387146,
                    23.1254577637,
                    4,
                    "point(113.3387146 23.1254577637)",
                    113.3387146,
                    23.1254577637,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9992\u5934"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_favorable_rate','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_favorable_rate','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,favorable_rate DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.0628639|209:0.031215|434:0.0048201|738:0.00519914|1346:0.0153657|882:0.0249161|1362:0.77585|218:0.00752052|267:0.0213094|269:0.00472298",
                    "[-0.053646, 0.230365, -0.050389, 0.174522, 0.149716, -0.281871, -0.287270, -0.053025, 0.521291, 0.218027, -0.151794, -0.301204, -0.305144, 0.190049, -0.282808, 0.121625, -0.200839, 0.036128, 0.065106, 0.144655]",
                    121.000603,
                    30.716352,
                    121.000603,
                    30.716352,
                    55,
                    "point(121.000603 30.716352)",
                    121.000603,
                    30.716352
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "450:0.00283985|263:0.00246362|778:0.00610914|209:0.0191527|1234:0.00507477|1362:0.00617108|1042:0.0136681|402:0.0347633|978:0.441364|212:0.00424582|214:0.0105693|218:0.00412136|858:0.00682783|221:0.0279694|223:0.00545028|225:0.017513|354:0.00250473|226:0.0451751|228:0.00476412|490:0.00381816|234:0.00766364|1322:0.0249101|874:0.0338375|240:0.0151033|241:0.0144043|562:0.00252572|1138:0.00262854|754:0.0147569|882:0.106067|249:0.0153141|762:0.0495287",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    114.937252,
                    25.847381,
                    114.937252,
                    25.847381,
                    129,
                    "point(114.937252 25.847381)",
                    114.937252,
                    25.847381
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u80af\u5fb7\u57fa",
                    117.3149871826172,
                    31.78679847717285,
                    117.3149871826172,
                    31.78679847717285,
                    17,
                    "point(117.3149871826172 31.78679847717285)",
                    117.3149871826172,
                    31.78679847717285,
                    "314",
                    0,
                    10000,
                    "\u80af\u5fb7\u57fa\u5b85\u6025\u9001 OR kfc OR \u80af\u5fb7\u57fa"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u852c\u83dc\u6c99\u62c9",
                    116.158123,
                    23.317209,
                    231,
                    116.158123,
                    23.317209,
                    "point(116.158123 23.317209)",
                    116.158123,
                    23.317209,
                    "314",
                    0,
                    10000,
                    "salad OR \u8272\u62c9 OR \u6c99\u62c9 OR \u6c99\u5f8b",
                    "\u852c\u83dc\u6c99\u62c9",
                    116.158123,
                    23.317209,
                    231,
                    116.158123,
                    23.317209,
                    "point(116.158123 23.317209)",
                    116.158123,
                    23.317209,
                    "314",
                    0,
                    10000,
                    "salad OR \u8272\u62c9 OR \u6c99\u62c9 OR \u6c99\u5f8b",
                    "\u852c\u83dc\u6c99\u62c9",
                    116.158123,
                    23.317209,
                    116.158123,
                    23.317209,
                    231,
                    "point(116.158123 23.317209)",
                    116.158123,
                    23.317209,
                    "314",
                    0,
                    10000,
                    "salad",
                    "\u8272\u62c9 OR \u6c99\u62c9 OR \u6c99\u5f8b"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  (QUERY(full_name,?) OR QUERY(name,?))) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "225:0.0078934|263:0.00805049|1322:0.00998064|1354:0.368631|236:0.0728621|209:0.0843688|1330:0.00496662|1362:0.0270033|882:0.0764669|570:0.00611313|1338:0.013553|218:0.0765969|221:0.188981|223:0.00656481",
                    "[-0.211565, 0.197626, 0.021214, 0.210230, 0.015856, -0.216412, -0.118946, 0.026223, 0.361665, 0.286223, -0.183400, -0.314541, -0.131501, 0.245331, -0.418805, 0.141525, -0.337289, 0.249584, -0.028409, 0.120620]",
                    113.67935,
                    23.63297,
                    113.67935,
                    23.63297,
                    4,
                    "point(113.67935 23.63297)",
                    113.67935,
                    23.63297
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "225:0.0145677|546:0.00593244|227:0.00578725|263:0.0274717|232:0.00401792|778:0.00508121|458:0.00563819|1354:0.00938564|236:0.0197051|209:0.0535676|1298:0.0110394|978:0.0180614|1362:0.0258136|882:0.171131|214:0.00602917|218:0.00611803|570:0.00956912|442:0.0102006|221:0.510817|222:0.00669771|223:0.0259782",
                    "[-0.212676, 0.206417, 0.055243, 0.196687, 0.042008, -0.217384, -0.090258, 0.030363, 0.315942, 0.303102, -0.085719, -0.314389, -0.084492, 0.282217, -0.494228, 0.192088, -0.294560, 0.201885, -0.018790, 0.136516]",
                    113.612412,
                    22.901999,
                    113.612412,
                    22.901999,
                    51,
                    "point(113.612412 22.901999)",
                    113.612412,
                    22.901999
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.933738|978:0.0291784",
                    "[-0.221836, -0.166475, -0.165115, -0.296232, 0.116195, 0.454490, -0.190402, -0.031810, 0.361318, -0.103193, -0.098836, -0.380749, -0.148619, 0.133721, -0.251064, -0.048233, -0.144315, -0.108412, 0.236194, -0.247177]",
                    114.042989,
                    22.598539,
                    114.042989,
                    22.598539,
                    11,
                    "point(114.042989 22.598539)",
                    114.042989,
                    22.598539
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1346:0.00316455|770:0.00636531|450:0.00684124|386:0.0550039|263:0.00327339|778:0.00974328|394:0.0316268|209:0.0272666|1042:0.00247068|1234:0.00303009|786:0.00436558|402:0.00998719|914:0.0120331|978:0.013491|214:0.00995892|410:0.00353579|218:0.00477017|794:0.00668253|858:0.00914332|221:0.00681096|223:0.00265061|1122:0.00284916|354:0.00372683|226:0.00584229|802:0.0136194|234:0.0022773|370:0.00847655|754:0.0287469|882:0.270895|378:0.00798074|826:0.00855375|762:0.365004",
                    "[-0.246226, 0.336745, -0.060627, 0.098387, 0.060415, -0.112155, -0.192975, 0.051909, 0.240591, 0.221894, -0.005431, -0.304375, -0.142299, 0.259319, -0.605317, 0.256954, -0.133210, 0.130632, -0.040810, 0.016059]",
                    121.548980713,
                    31.1834907532,
                    121.548980713,
                    31.1834907532,
                    1,
                    "point(121.548980713 31.1834907532)",
                    121.548980713,
                    31.1834907532
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "418:0.0100452|482:0.0157692|802:0.016834|770:0.216791|874:0.00872855|490:0.02469|778:0.334171|978:0.0141553|754:0.0161971|786:0.107457|882:0.122944|212:0.0264746|762:0.017178|410:0.0229023",
                    "[-0.168432, 0.327349, -0.037816, -0.005387, 0.164830, -0.066063, -0.147461, 0.264991, 0.335455, -0.030375, -0.061850, -0.331154, -0.123923, 0.159940, -0.642870, 0.149446, -0.075955, 0.132184, 0.052135, -0.100300]",
                    120.320603,
                    31.561409,
                    120.320603,
                    31.561409,
                    35,
                    "point(120.320603 31.561409)",
                    120.320603,
                    31.561409
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u7c73\u80a0",
                    120.084114074707,
                    29.3223991394043,
                    67,
                    120.084114074707,
                    29.3223991394043,
                    "point(120.084114074707 29.3223991394043)",
                    120.084114074707,
                    29.3223991394043,
                    "209",
                    0,
                    10000,
                    "\u7ea2\u80a0 OR \u7092\u7c73\u7cd5 OR \u54b8\u80a0 OR \u7092\u7c73\u6761 OR \u9c7c\u80a0 OR \u8089\u80a0 OR \u7c73\u997a OR \u52a0\u80a0",
                    "\u7c73\u80a0",
                    120.084114074707,
                    29.3223991394043,
                    67,
                    120.084114074707,
                    29.3223991394043,
                    "point(120.084114074707 29.3223991394043)",
                    120.084114074707,
                    29.3223991394043,
                    "209",
                    0,
                    10000,
                    "\u7ea2\u80a0 OR \u7092\u7c73\u7cd5 OR \u54b8\u80a0 OR \u7092\u7c73\u6761 OR \u9c7c\u80a0 OR \u8089\u80a0 OR \u7c73\u997a OR \u52a0\u80a0"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6c99\u62c9",
                    116.2984924316406,
                    39.94941711425781,
                    3,
                    116.2984924316406,
                    39.94941711425781,
                    "point(116.2984924316406 39.94941711425781)",
                    116.2984924316406,
                    39.94941711425781,
                    "1074|212|1090|1106|1114|1122|1138|1154|1130|1170|1162|1234|1066|1186|1050|1058|1178|1146|370|882|268|594|530|538|1082|209|546|666|1338|562|570|578|586|602|226|698|810|228|690|267|610|222|269|682|674|658|650|227|642|1042|266|626|618|1194|224|506|634|1098|225|221|706|554|263|522|898|514|223|1218|442|818|1210|434|1202|232|426|1226|450",
                    "314",
                    0,
                    10000,
                    "'#\u8272\u62c9\u8f7b\u98df\u8272\u62c9'",
                    "\u6c99\u62c9",
                    116.2984924316406,
                    39.94941711425781,
                    3,
                    116.2984924316406,
                    39.94941711425781,
                    "point(116.2984924316406 39.94941711425781)",
                    116.2984924316406,
                    39.94941711425781,
                    "1074|212|1090|1106|1114|1122|1138|1154|1130|1170|1162|1234|1066|1186|1050|1058|1178|1146|370|882|268|594|530|538|1082|209|546|666|1338|562|570|578|586|602|226|698|810|228|690|267|610|222|269|682|674|658|650|227|642|1042|266|626|618|1194|224|506|634|1098|225|221|706|554|263|522|898|514|223|1218|442|818|1210|434|1202|232|426|1226|450",
                    "314",
                    0,
                    10000,
                    "'#\u8272\u62c9\u8f7b\u98df\u8272\u62c9'"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(tag_names,?))))))) )  UNION ALL  ( select CAST(9 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(tag_names,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u6c99\u62c9",
                    116.2984924316406,
                    39.94941711425781,
                    3,
                    116.2984924316406,
                    39.94941711425781,
                    "point(116.2984924316406 39.94941711425781)",
                    116.2984924316406,
                    39.94941711425781,
                    "314",
                    0,
                    10000,
                    "salad OR \u8272\u62c9 OR \u6c99\u62c9 OR \u6c99\u5f8b",
                    "\u6c99\u62c9",
                    116.2984924316406,
                    39.94941711425781,
                    3,
                    116.2984924316406,
                    39.94941711425781,
                    "point(116.2984924316406 39.94941711425781)",
                    116.2984924316406,
                    39.94941711425781,
                    "314",
                    0,
                    10000,
                    "salad OR \u8272\u62c9 OR \u6c99\u62c9 OR \u6c99\u5f8b",
                    "\u6c99\u62c9",
                    116.2984924316406,
                    39.94941711425781,
                    116.2984924316406,
                    39.94941711425781,
                    3,
                    "point(116.2984924316406 39.94941711425781)",
                    116.2984924316406,
                    39.94941711425781,
                    "314",
                    0,
                    10000,
                    "salad",
                    "\u8272\u62c9 OR \u6c99\u62c9 OR \u6c99\u5f8b"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  (QUERY(full_name,?) OR QUERY(name,?))) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u70e4\u8089\u996d",
                    118.7880706787109,
                    32.03755950927734,
                    6,
                    118.7880706787109,
                    32.03755950927734,
                    "point(118.7880706787109 32.03755950927734)",
                    118.7880706787109,
                    32.03755950927734,
                    "314",
                    0,
                    10000,
                    "\u70e4\u996d OR \u70e4\u8089",
                    "\u70e4\u8089\u996d",
                    118.7880706787109,
                    32.03755950927734,
                    6,
                    118.7880706787109,
                    32.03755950927734,
                    "point(118.7880706787109 32.03755950927734)",
                    118.7880706787109,
                    32.03755950927734,
                    "314",
                    0,
                    10000,
                    "\u70e4\u996d OR \u70e4\u8089",
                    "\u70e4\u8089\u996d",
                    118.7880706787109,
                    32.03755950927734,
                    118.7880706787109,
                    32.03755950927734,
                    6,
                    "point(118.7880706787109 32.03755950927734)",
                    118.7880706787109,
                    32.03755950927734,
                    "314",
                    0,
                    10000,
                    "\u70e4\u996d",
                    "\u70e4\u8089"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  (QUERY(full_name,?) OR QUERY(name,?))) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1154:0.0028233|770:0.00525489|386:0.00910447|263:0.0239834|394:0.00273009|842:0.00816562|266:0.0091289|778:0.039054|209:0.0787597|466:0.014859|978:0.024027|914:0.171689|794:0.00355333|221:0.00289161|225:0.00520405|802:0.00619781|682:0.00354878|236:0.00770705|754:0.00343058|370:0.0143472|882:0.139234|1018:0.00347641|378:0.00798027|506:0.00923579|762:0.35522",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    113.926221728,
                    22.5250608847,
                    113.926221728,
                    22.5250608847,
                    11,
                    "point(113.926221728 22.5250608847)",
                    113.926221728,
                    22.5250608847
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.324876|209:0.0143564|241:0.251726|738:0.0164673|242:0.0535681|978:0.26021|212:0.0140625|250:0.0193158",
                    "[-0.163130, -0.137153, -0.199450, -0.344002, 0.081628, 0.394755, -0.195875, -0.018185, 0.417385, -0.132057, -0.119215, -0.340452, -0.144266, 0.131031, -0.307193, -0.079581, -0.194782, -0.118403, 0.182127, -0.222906]",
                    121.487197876,
                    31.3656082153,
                    121.487197876,
                    31.3656082153,
                    1,
                    "point(121.487197876 31.3656082153)",
                    121.487197876,
                    31.3656082153
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.00572609|978:0.00446684|786:0.00450367|770:0.0148648|882:0.0592729|778:0.859703|222:0.00495836",
                    "[-0.200385, 0.347806, -0.011296, -0.004000, 0.155964, -0.034786, -0.156686, 0.235215, 0.295086, -0.081547, -0.080799, -0.351541, -0.053618, 0.127778, -0.628779, 0.146883, -0.064738, 0.208658, 0.010870, -0.159688]",
                    113.782027,
                    22.797301,
                    113.782027,
                    22.797301,
                    51,
                    "point(113.782027 22.797301)",
                    113.782027,
                    22.797301
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "273:0.0304129|882:0.0161265|978:0.145019|245:0.030485|490:0.0119192|234:0.0121678|254:0.393986|271:0.312642",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    104.006523132,
                    30.5697078705,
                    104.006523132,
                    30.5697078705,
                    14,
                    "point(104.006523132 30.5697078705)",
                    104.006523132,
                    30.5697078705
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1234:0.00936667|882:0.0231618|212:0.172693|1162:0.196738|234:0.556413",
                    "[-0.134736, 0.234663, -0.133629, 0.251496, 0.093379, 0.036647, -0.100677, -0.186542, 0.399482, -0.084396, -0.433711, -0.372957, -0.317088, 0.209042, -0.204577, -0.039292, -0.262071, 0.184051, 0.019536, -0.078669]",
                    120.42068392,
                    27.5168909132,
                    120.42068392,
                    27.5168909132,
                    30,
                    "point(120.42068392 27.5168909132)",
                    120.42068392,
                    27.5168909132
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "882:0.0580337|212:0.0597172|234:0.841552",
                    "[-0.097084, 0.231408, -0.140820, 0.242635, 0.075408, 0.070117, -0.124599, -0.207301, 0.381609, -0.074091, -0.460846, -0.351211, -0.349759, 0.186482, -0.199436, -0.040795, -0.253594, 0.189387, 0.010214, -0.059588]",
                    119.317693,
                    26.119796,
                    119.317693,
                    26.119796,
                    9,
                    "point(119.317693 26.119796)",
                    119.317693,
                    26.119796
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u77f3\u58a8\u80a0\u7c89",
                    119.634909667,
                    29.1338099912,
                    119.634909667,
                    29.1338099912,
                    67,
                    "point(119.634909667 29.1338099912)",
                    119.634909667,
                    29.1338099912,
                    "314",
                    0,
                    10000,
                    "\u77f3\u78e8\u80a0\u7c89 OR \u77f3\u58a8\u80a0\u7c89"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "225:0.00438401|263:0.00655644|1354:0.00577526|236:0.0158163|209:0.0337892|754:0.00539401|978:0.00634702|1362:0.0164809|1298:0.0379931|882:0.169895|570:0.00495438|442:0.00661627|221:0.623738|222:0.0153697",
                    "[-0.286950, 0.197462, 0.052428, 0.217957, 0.105440, -0.194549, -0.001190, -0.059833, 0.321527, 0.219973, -0.164271, -0.350397, -0.078801, 0.265885, -0.447622, 0.176530, -0.319419, 0.248205, -0.021274, 0.042619]",
                    113.245643616,
                    22.8446292877,
                    113.245643616,
                    22.8446292877,
                    24,
                    "point(113.245643616 22.8446292877)",
                    113.245643616,
                    22.8446292877
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "450:0.00465333|770:0.00678189|354:0.00801882|874:0.00369117|1034:0.0393533|778:0.0479139|490:0.096395|234:0.12528|240:0.228435|209:0.00908047|241:0.0174813|1138:0.00307126|434:0.00417736|786:0.0109051|754:0.0148913|402:0.0210913|882:0.0973999|978:0.137806|212:0.0500468|214:0.00516204|762:0.00370222|858:0.00608787|218:0.00895129",
                    "[-0.175239, 0.178467, -0.247423, 0.041579, 0.122465, 0.117694, -0.142276, 0.022283, 0.483762, -0.141182, -0.266449, -0.367686, -0.198933, 0.189881, -0.426007, 0.071957, -0.209241, 0.085095, 0.195751, -0.114583]",
                    119.289012,
                    26.066645,
                    119.289012,
                    26.066645,
                    9,
                    "point(119.289012 26.066645)",
                    119.289012,
                    26.066645
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9ebb\u8fa3\u70eb",
                    126.09901998192072,
                    46.685807928442955,
                    126.09901998192072,
                    46.685807928442955,
                    228,
                    "point(126.09901998192072 46.685807928442955)",
                    126.09901998192072,
                    46.685807928442955,
                    "314",
                    "214",
                    0,
                    10000
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(10 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND contain(main_category_id, ?) AND avg_cost>=? AND avg_cost<=?) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.0219943|418:0.0125427|978:0.0149916|370:0.024552|786:0.0457544|770:0.0963251|882:0.139641|802:0.498759|794:0.00653997|762:0.0165556|778:0.0245249|410:0.0533735",
                    "[-0.184212, 0.361827, 0.023024, 0.008068, 0.183602, -0.172026, -0.213815, 0.295407, 0.231862, 0.014963, -0.039416, -0.244968, -0.116603, 0.212640, -0.607907, 0.264758, -0.052478, 0.142690, -0.029347, -0.016902]",
                    120.5048828125,
                    30.10430526733398,
                    120.5048828125,
                    30.10430526733398,
                    69,
                    "point(120.5048828125 30.10430526733398)",
                    120.5048828125,
                    30.10430526733398
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u5c0f\u9984\u9968",
                    120.5048828125,
                    30.10430526733398,
                    69,
                    120.5048828125,
                    30.10430526733398,
                    "point(120.5048828125 30.10430526733398)",
                    120.5048828125,
                    30.10430526733398,
                    "1034|236|1338|962|218|970|978|1471|986|994|1002|1010|466|882|418|794|450|1018|266|802|426|898|410|786|269|267|818|442|434|810|362|268|778|402|370|746|354|906|378|754|770|394|386|762|209|914",
                    "314",
                    0,
                    10000,
                    "\u6241\u98df OR \u9984\u9968 OR \u6284\u624b",
                    "\u5c0f\u9984\u9968",
                    120.5048828125,
                    30.10430526733398,
                    69,
                    120.5048828125,
                    30.10430526733398,
                    "point(120.5048828125 30.10430526733398)",
                    120.5048828125,
                    30.10430526733398,
                    "1034|236|1338|962|218|970|978|1471|986|994|1002|1010|466|882|418|794|450|1018|266|802|426|898|410|786|269|267|818|442|434|810|362|268|778|402|370|746|354|906|378|754|770|394|386|762|209|914",
                    "314",
                    0,
                    10000,
                    "\u6241\u98df OR \u9984\u9968 OR \u6284\u624b",
                    "\u5c0f\u9984\u9968",
                    120.5048828125,
                    30.10430526733398,
                    120.5048828125,
                    30.10430526733398,
                    69,
                    "point(120.5048828125 30.10430526733398)",
                    120.5048828125,
                    30.10430526733398,
                    "1034|236|1338|962|218|970|978|1471|986|994|1002|1010|466|882|418|794|450|1018|266|802|426|898|410|786|269|267|818|442|434|810|362|268|778|402|370|746|354|906|378|754|770|394|386|762|209|914",
                    "314",
                    0,
                    10000,
                    "\u6241\u98df OR \u9984\u9968 OR \u6284\u624b"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9e21\u86cb\u997c",
                    118.9059448242188,
                    32.07808303833008,
                    6,
                    118.9059448242188,
                    32.07808303833008,
                    "point(118.9059448242188 32.07808303833008)",
                    118.9059448242188,
                    32.07808303833008,
                    "1074|1090|1098|1106|1114|1122|1234|1066|1050|1058|1338|1034|1018|962|970|978|1471|986|914|1082|209|762|1162|386|1170|394|770|1154|378|906|1130|354|746|1146|370|1178|402|778|268|1138|362|810|1210|434|1218|442|236|818|754|269|786|1186|410|898|1202|426|802|1042|266|1226|450|212|794|1194|418|922|874|498|954|866|490|938|930|267|946|858|882|466|234|1010|1002|218|994",
                    "314",
                    0,
                    10000,
                    "\u86cb\u997c",
                    "\u9e21\u86cb\u997c",
                    118.9059448242188,
                    32.07808303833008,
                    6,
                    118.9059448242188,
                    32.07808303833008,
                    "point(118.9059448242188 32.07808303833008)",
                    118.9059448242188,
                    32.07808303833008,
                    "1074|1090|1098|1106|1114|1122|1234|1066|1050|1058|1338|1034|1018|962|970|978|1471|986|914|1082|209|762|1162|386|1170|394|770|1154|378|906|1130|354|746|1146|370|1178|402|778|268|1138|362|810|1210|434|1218|442|236|818|754|269|786|1186|410|898|1202|426|802|1042|266|1226|450|212|794|1194|418|922|874|498|954|866|490|938|930|267|946|858|882|466|234|1010|1002|218|994",
                    "314",
                    0,
                    10000,
                    "\u86cb\u997c",
                    "\u9e21\u86cb\u997c",
                    118.9059448242188,
                    32.07808303833008,
                    118.9059448242188,
                    32.07808303833008,
                    6,
                    "point(118.9059448242188 32.07808303833008)",
                    118.9059448242188,
                    32.07808303833008,
                    "1074|1090|1098|1106|1114|1122|1234|1066|1050|1058|1338|1034|1018|962|970|978|1471|986|914|1082|209|762|1162|386|1170|394|770|1154|378|906|1130|354|746|1146|370|1178|402|778|268|1138|362|810|1210|434|1218|442|236|818|754|269|786|1186|410|898|1202|426|802|1042|266|1226|450|212|794|1194|418|922|874|498|954|866|490|938|930|267|946|858|882|466|234|1010|1002|218|994",
                    "314",
                    0,
                    10000,
                    "\u86cb\u997c"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND contain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u65e0\u7c73\u7092\u996d",
                    117.28857421875,
                    31.24261665344238,
                    17,
                    117.28857421875,
                    31.24261665344238,
                    "point(117.28857421875 31.24261665344238)",
                    117.28857421875,
                    31.24261665344238,
                    "306|322|1450|254|290|271|1418|338|246|1370|270|1394|247|1442|258|1386|245|1466|282|1410|1458|274|255|1402|330|256|273|257|298|1378|314",
                    "314",
                    0,
                    10000,
                    "\u77f3\u9505\u62cc\u996d OR \u7092\u997c OR \u94c1\u677f\u996d OR \u7c73\u996d OR \u6284\u996d OR \u86cb\u5305\u996d OR \u76d6\u996d OR \u7092\u7c89 OR \u4efd\u996d OR \u70e9\u996d OR \u7092\u9762",
                    "\u65e0\u7c73\u7092\u996d",
                    117.28857421875,
                    31.24261665344238,
                    17,
                    117.28857421875,
                    31.24261665344238,
                    "point(117.28857421875 31.24261665344238)",
                    117.28857421875,
                    31.24261665344238,
                    "306|322|1450|254|290|271|1418|338|246|1370|270|1394|247|1442|258|1386|245|1466|282|1410|1458|274|255|1402|330|256|273|257|298|1378|314",
                    "314",
                    0,
                    10000,
                    "\u77f3\u9505\u62cc\u996d OR \u7092\u997c OR \u94c1\u677f\u996d OR \u7c73\u996d OR \u6284\u996d OR \u86cb\u5305\u996d OR \u76d6\u996d OR \u7092\u7c89 OR \u4efd\u996d OR \u70e9\u996d OR \u7092\u9762"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', '-store_score','100',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(main_category_id, ?) AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  )  limit 600 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "1314:0.0220215|618:0.0365943|778:0.0412003|269:0.0762827|240:0.0572175|209:0.0250457|241:0.00660051|754:0.00864112|882:0.0678291|978:0.257681|218:0.00835792|794:0.0236877|826:0.162722|221:0.128088|222:0.0332695",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    118.255294673,
                    24.6007478423,
                    118.255294673,
                    24.6007478423,
                    13,
                    "point(118.255294673 24.6007478423)",
                    118.255294673,
                    24.6007478423
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.00572609|978:0.00446684|786:0.00450367|770:0.0148648|882:0.0592729|778:0.859703|222:0.00495836",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    117.196861267,
                    29.2991943359,
                    117.196861267,
                    29.2991943359,
                    49,
                    "point(117.196861267 29.2991943359)",
                    117.196861267,
                    29.2991943359
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "212:0.948271|234:0.0219228",
                    "[-0.038000, 0.203143, -0.233690, 0.265414, 0.052343, 0.115834, -0.087871, -0.149793, 0.363702, -0.155915, -0.463145, -0.364425, -0.350832, 0.215400, -0.173099, -0.006914, -0.193364, 0.180640, 0.011028, -0.111289]",
                    120.59789,
                    27.96935,
                    120.59789,
                    27.96935,
                    30,
                    "point(120.59789 27.96935)",
                    120.59789,
                    27.96935
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u70b8\u9e21",
                    104.068206787,
                    30.5298423767,
                    14,
                    104.068206787,
                    30.5298423767,
                    "point(104.068206787 30.5298423767)",
                    104.068206787,
                    30.5298423767,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9e21",
                    "\u70b8\u9e21",
                    104.068206787,
                    30.5298423767,
                    14,
                    104.068206787,
                    30.5298423767,
                    "point(104.068206787 30.5298423767)",
                    104.068206787,
                    30.5298423767,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9e21",
                    "\u70b8\u9e21",
                    104.068206787,
                    30.5298423767,
                    104.068206787,
                    30.5298423767,
                    14,
                    "point(104.068206787 30.5298423767)",
                    104.068206787,
                    30.5298423767,
                    "314",
                    0,
                    10000,
                    "\u70b8\u9e21"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'delivery_price','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,?) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate AS store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  commodity INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=0)  AS Store ON Store.store_id=commodity.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( select CAST(2 as BIGINT)  as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,real_price,distance,item_id,min_sku_id,eleme_item_id,min_eleme_food_id,eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,food_name,store_name,monthly_sales_volume,d_time from table(rankTvf('', 'delivery_price','180',(select *,bit_value(delivery_bit , 0 , 20) as area_agent_fee,bit_value(delivery_bit , 40 , 20) as delivery_price from table(rankTvf('store_id', '-monthly_sales_volume','6',(SELECT Store.store_id,Store.ele_shop_id,Store.dist_brand_info,Store.logo,Store.effective_supply_value,Store.is_starbucks_agent_shop,Store.recent_order_num,Store.delivery_product_id,Store.main_category_id,Store.avg_cost,Store.is_premium,Store.whole_city_brand_info,Store.is_new_retail,Store.flavor_ids,store_status,eleme_shop_score(store_status ,distance ,Store.store_name1 ,Store.favorable_rate ,recent_order_num ,? ) AS store_score,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,item_id as item_id,eleme_item_id as min_sku_id,eleme_item_id,eleme_item_id as min_eleme_food_id,eleme_item_id as eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_tag_names,category_info,DUP_name as food_name,store_name,store_name1,monthly_sales_volume,0 AS real_price,Store.favorable_rate as store_favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM  goods INNER JOIN  (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,DUP_full_name as store_name,DUP_name as store_name1,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,favorable_rate,recent_order_num,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,delivery_tmodel,delivery_a_tmodel,avg_delivery_time FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND is_new_retail=1)  AS Store ON Store.store_id=goods.store_id WHERE  QUERY(name,?))))))) )  UNION ALL  ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC,bit_value(delivery_bit , 40 , 20) ASC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "\u9ebb\u8fa3\u9999\u9505",
                    103.983974,
                    30.756504,
                    103.983974,
                    30.756504,
                    14,
                    "point(103.983974 30.756504)",
                    103.983974,
                    30.756504,
                    "314",
                    0,
                    10000,
                    "\u9ebb\u8fa3\u9999\u9505"
                ]
            ],
            "sql": "SELECT store_id AS storeId,hit_type AS hitType,dist_brand_info AS deliveryMode,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,eleme_item_id AS eleItemIds,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_promotions AS storePromotions,ele_huichang AS elemeHuichang,store_attributes AS storeAttributes,brand_id AS brandId,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM ( ( SELECT CAST(1 as BIGINT) as hit_type,store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_score,store_status,delivery_bit,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS eleme_item_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,flavor_ids,DUP_name,DUP_full_name,eleme_shop_score(store_status ,distance ,DUP_name ,favorable_rate ,recent_order_num ,?) AS store_score,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,dist_brand_info,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,ele_huichang,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_full_name,DUP_name,favorable_rate,recent_order_num,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0 AND notcontain(flavor_ids, ?) AND avg_cost>=? AND avg_cost<=? AND  QUERY(name,?)) ORDER BY store_score DESC limit 180) )  )  limit 1080 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "225:0.00305614|450:0.00682231|263:0.00427207|1354:0.218991|267:0.00514491|236:0.00397179|269:0.00917453|209:0.321995|1234:0.00258054|978:0.00458771|434:0.00663998|1362:0.0156882|882:0.236467|218:0.00437576|442:0.00447454|221:0.0967933|222:0.00584055",
                    "[-0.253004, 0.201713, -0.042667, 0.300365, 0.089073, -0.146251, -0.099245, -0.098174, 0.343524, 0.139939, -0.267193, -0.351167, -0.134361, 0.269557, -0.362763, 0.080498, -0.372233, 0.233074, -0.014006, 0.016737]",
                    119.72887,
                    30.25672,
                    119.72887,
                    30.25672,
                    2,
                    "point(119.72887 30.25672)",
                    119.72887,
                    30.25672
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "240:0.933738|978:0.0291784",
                    "[-0.221836, -0.166475, -0.165115, -0.296232, 0.116195, 0.454490, -0.190402, -0.031810, 0.361318, -0.103193, -0.098836, -0.380749, -0.148619, 0.133721, -0.251064, -0.048233, -0.144315, -0.108412, 0.236194, -0.247177]",
                    117.310104,
                    31.826057,
                    117.310104,
                    31.826057,
                    17,
                    "point(117.310104 31.826057)",
                    117.310104,
                    31.826057
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "254:0.534233|271:0.4499",
                    "0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0",
                    113.998757,
                    22.897675,
                    113.998757,
                    22.897675,
                    51,
                    "point(113.998757 22.897675)",
                    113.998757,
                    22.897675
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.019639|225:0.266534|978:0.0834085|882:0.122163|263:0.0423192|570:0.0111995|874:0.0214407|762:0.00679807|221:0.381252",
                    "[-0.113126, 0.171627, 0.069203, 0.225965, -0.013692, -0.199715, -0.161856, 0.104408, 0.226725, 0.307780, 0.009546, -0.317506, -0.053300, 0.363588, -0.538011, 0.197202, -0.207805, 0.141802, 0.014872, 0.225383]",
                    103.928479739,
                    30.5886079744,
                    103.928479739,
                    30.5886079744,
                    14,
                    "point(103.928479739 30.5886079744)",
                    103.928479739,
                    30.5886079744
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        },
        {
            "sql_params": {
                "iquan.plan.prepare.level": "rel.post.optimize",
                "iquan.plan.cache.enable": "true"
            },
            "dynamic_params": [
                [
                    "209:0.00797797|466:0.0309139|882:0.0338501|978:0.0764652|218:0.00699943|1018:0.00785941|234:0.0160193|346:0.766698|236:0.00518848",
                    "[-0.241318, 0.240258, 0.000825, 0.200686, -0.223925, -0.043359, -0.163401, -0.071517, 0.346866, 0.323744, -0.224968, -0.252964, -0.289225, 0.031794, -0.264438, -0.004119, -0.390066, 0.245346, -0.096113, 0.209789]",
                    114.057932943,
                    22.5066419877,
                    114.057932943,
                    22.5066419877,
                    11,
                    "point(114.057932943 22.5066419877)",
                    114.057932943,
                    22.5066419877
                ]
            ],
            "sql": "SELECT store_id AS storeId,CAST(10 as BIGINT)  AS hitType,logo AS isLogo,effective_supply_value AS isMenu,store_favorable_rate AS likeRateScore,ele_shop_id AS eleShopId,main_category_id AS mainCategoryId,recent_order_num AS recentOrderNum,avg_cost AS unitPrice,is_premium,whole_city_brand_info AS isWholeCity,is_new_retail AS isNewRetail,flavor_ids AS flavorIds,store_score AS baseScore,store_status AS openStatus,real_price ,distance AS distance,item_id AS itemId,min_sku_id ,min_eleme_food_id AS foodids,reserve_status AS canReserve,reserve_days AS crossDayReserve,store_attributes AS storeAttributes,brand_id AS itemId,DUP_tag_names AS foodTagNames,category_info AS foodCategoryInfo,food_name AS foodnames,monthly_sales_volume AS foodSaleCount,delivery_product_id as productId,d_time as deliveryTime,is_starbucks_agent_shop as isStarbucksAgentShop,delivery_bit AS deliveryBit,store_name AS storeName FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,favorable_rate as store_favorable_rate,recent_order_num,delivery_product_id,main_category_id,avg_cost,is_premium,whole_city_brand_info,is_new_retail,flavor_ids,store_status,CAST(0 AS INT) AS real_price,distance,CAST(0 AS BIGINT) AS item_id,CAST(0 AS BIGINT) AS min_sku_id,CAST(0 AS BIGINT) AS min_eleme_food_id,CAST(0 AS BIGINT) AS eleme_vfood_id,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,'' AS DUP_tag_names,'' AS category_info,CAST(0 AS BIGINT) AS cat1_id,CAST(0 AS BIGINT) AS cat2_id,CAST(0 AS BIGINT) AS cat3_id,'' AS food_name,DUP_full_name AS store_name,CAST(0 AS BIGINT) AS monthly_sales_volume,favorable_rate,d_time, delivery_bit, eleme_shop_rank_default(  distance, delivery_bit, recent_order_num,main_category_id,?,?,embedding) as store_score FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,recent_order_num,main_category_id,avg_cost,is_new_retail,is_premium,whole_city_brand_info,reserve_status,reserve_days,store_promotions,store_attributes,brand_id,flavor_ids,DUP_full_name,store_status,delivery_fee_compute(poly ,distance ,delivery_price ,delivery_area_agent_fee ,delivery_fee_calculate_template ,delivery_promotion) AS delivery_bit,distance,favorable_rate,recent_order_num,main_category_id,embedding,eleme_tmodel(distance ,delivery_a_tmodel ,avg_delivery_time,delivery_product_id) AS d_time FROM   (SELECT store_id,ele_shop_id,logo,effective_supply_value,is_starbucks_agent_shop,delivery_product_id,main_category_id,embedding,avg_cost,is_premium,whole_city_brand_info,eleme_check_reserve(can_reserve, open_time, reserve_days) as reserve_status,reserve_days,store_promotions,store_attributes,brand_id,is_new_retail,flavor_ids,avg_delivery_time,delivery_tmodel,delivery_a_tmodel,DUP_name,DUP_full_name,favorable_rate,recent_order_num,main_category_id,eleme_check_shop_status(can_reserve, busy_level, open_time, will_close_at,reserve_days) AS store_status,delivery_price,delivery_area_agent_fee,delivery_fee_calculate_template,delivery_promotion,eleme_delivery_function(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) AS poly,eleme_distance_compute(longitude ,latitude ,CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,CAST(? AS BIGINT)) AS distance FROM  store,unnest(store.sub_delivery_table) WHERE  MATCHINDEX('delivery_polygon' , ? ) AND eleme_delivery_filter(CAST(? AS DOUBLE) ,CAST(? AS DOUBLE) ,delivery_multi_period ,delivery_polygon) >= 0) WHERE  store_status=5)) ORDER BY store_score desc limit 100 "
        }
    ]
}
